# Metadata Standards Reference

## Metadata Column Naming Convention

### Actual Column Names (as generated by macros)
```sql
_source_system         -- Source system identifier (e.g., 'JENZABAR_CX', 'POWERFAIDS')
_source_table          -- Source table name (e.g., 'PROG_ENR_REC')
_source_file           -- Optional: Source file name (if specified in source meta)
_data_classification   -- Data classification (e.g., 'INTERNAL', 'CONFIDENTIAL')
_data_owner            -- Data owner/steward (e.g., 'REGISTRAR', 'FINANCE')
_ingest_type           -- Ingestion method (e.g., 'FULL_LOAD', 'INCREMENTAL')
_dbt_loaded_at         -- Timestamp when dbt processed the record
_source_loaded_at      -- Optional: Timestamp from source system (with timestamp macro)
```

## Macro Usage

### Basic Metadata Macro
Use `add_source_metadata()` in most staging models:

```sql
{{ 
    config(
        materialized='view'
    )
}}

select
    -- Business columns
    student_id,
    first_name,
    last_name,
    
    -- Metadata columns (no trailing comma needed)
    {{ add_source_metadata('jenzabar_cx_archive', 'prog_enr_rec') }}
    
from {{ source('jenzabar_cx_archive', 'prog_enr_rec') }}
```

### Enhanced Metadata Macro with Source Timestamp
Use `add_source_metadata_with_timestamp()` when source has a load timestamp:

```sql
select
    student_id,
    first_name,
    {{ add_source_metadata_with_timestamp('powerfaids', 'bronze_pf_awards', '_loaded_at') }}
from {{ source('powerfaids', 'bronze_pf_awards') }}
```

## Source Configuration

### Required Meta Fields in sources.yml
```yaml
sources:
  - name: jenzabar_cx_archive
    schema: deposit
    
    tables:
      - name: prog_enr_rec
        meta:
          source_system: JENZABAR_CX      # Required
          data_owner: REGISTRAR            # Required
          data_class: INTERNAL             # Required
          ingest_type: FULL_LOAD           # Required
          source_file: prog_enr.csv        # Optional
          contains_pii: false              # For documentation
```

## Default Values

From `metadata_defaults()` macro (used when meta not specified):

```yaml
meta_source_system: UNKNOWN
meta_source_file: UNKNOWN
meta_ingest_type: UNKNOWN
meta_data_owner: UNKNOWN
meta_data_class: INTERNAL
```

Note: The defaults use `meta_` prefix but map to columns with `_` prefix.

## Data Classification Values

Standard values for `data_class`:
- `PUBLIC` - Can be freely shared externally
- `INTERNAL` - For institutional use only
- `CONFIDENTIAL` - Sensitive data, restricted access
- `RESTRICTED` - Highly sensitive (PII, FERPA, etc.)

## Common Source Systems

Standard identifiers for `source_system`:
- `JENZABAR_CX` - Jenzabar CX (SIS)
- `POWERFAIDS` - PowerFaids (Financial Aid)
- `SLATE` - Slate (Admissions/CRM)
- `COLLEAGUE` - Colleague (ERP)
- `BANNER` - Banner (ERP)
- `CSV_UPLOAD` - Manual CSV uploads
- `API_INTEGRATION` - External API sources

## Common Data Owners

Standard identifiers for `data_owner`:
- `REGISTRAR` - Registrar's Office
- `FINANCE` - Finance/Bursar
- `FINANCIAL_AID` - Financial Aid Office
- `ADMISSIONS` - Admissions Office
- `IT` - Information Technology
- `INSTITUTIONAL_RESEARCH` - IR Office
- `ADVANCEMENT` - Advancement/Development

## Ingest Types

Standard values for `ingest_type`:
- `FULL_LOAD` - Complete refresh of all records
- `INCREMENTAL` - Only new/changed records
- `CDC` - Change Data Capture
- `API_SYNC` - API synchronization
- `MANUAL_UPLOAD` - Manual file upload
- `SCHEDULED_BATCH` - Scheduled batch process